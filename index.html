<!DOCTYPE html>   
 <html lang="th">    
<head>    
<meta charset="UTF-8">    
<meta name="viewport" content="width=device-width, initial-scale=1.0">    
<title>DD WEB SHOP - Dark Draft</title>  <style>    
*{box-sizing:border-box;font-family:system-ui,-apple-system}    
body{margin:0;background:#000;color:#fff}    /* ===== ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ç‡∏≠ ===== */
.right{
font-size:20px;
cursor:pointer;
}
/* ===================== */

nav{
position:fixed;
top:0;
right:-260px;
width:260px;
height:100vh;
padding:20px;
padding-top:72px;
background:#0f0f0f;
transition:.3s;
z-index:50;
  overflow-y:auto;   /* üëà ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡πÑ‡∏î‡πâ */
  -webkit-overflow-scrolling: touch;

}

nav.active{
right:0;
}

nav button{
width:100%;margin-bottom:10px;padding:10px;
background:#151515;color:#fff;border:1px solid rgba(255,255,255,.08);
border-radius:10px;text-align:left
}

section{padding:16px;display:none}
section.active{display:block}

.banner{
position:relative;height:140px;overflow:hidden;
border-radius:12px;margin-bottom:20px;
}
.banner-track{display:flex;height:100%}
.banner-slide{
min-width:100%;
background:#111;
display:flex;align-items:center;justify-content:center;
color:#aaa;font-size:18px;font-weight:600
}

.dots{
position:absolute;bottom:8px;left:50%;
transform:translateX(-50%);
display:flex;gap:6px
}
.dot{width:8px;height:8px;border-radius:50%;background:#444}
.dot.active{background:#fff}

.stats{
display:grid;grid-template-columns:repeat(3,1fr);
gap:10px;margin-top:20px
}
.stat{
background:#0f0f0f;border-radius:12px;
padding:12px;text-align:center;
border:1px solid rgba(255,255,255,.06)
}
.stat b{font-size:18px}

.categories button{
margin-right:8px;margin-bottom:10px;
padding:8px 14px;border-radius:8px;
border:1px solid rgba(255,255,255,.1);
background:#111;color:#fff
}

.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.card{
background:#0f0f0f;border-radius:14px;padding:12px;
border:1px solid rgba(255,255,255,.06)
}
.img{
height:80px;background:#111;border-radius:10px;
display:flex;align-items:center;justify-content:center;color:#777
}

.price{color:#fff;font-weight:700}

.buy{
margin-top:8px;width:100%;
background:#fff;color:#000;border:none;
padding:10px;border-radius:10px;font-weight:600
}

input{
width:100%;padding:10px;margin-bottom:10px;
border-radius:8px;border:1px solid rgba(255,255,255,.1);
background:#0f0f0f;color:#fff
}

.history-item{
background:#0f0f0f;border-radius:10px;
padding:10px;margin-bottom:8px;
border:1px solid rgba(255,255,255,.06)
}
#pointBox{
position:relative;   /* ‚Üê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç */
display:flex;
align-items:center;
gap:6px;
padding:6px 14px;

background:#1a1a1a;
border:1px solid #fff;
border-radius:9999px;

color:#fff;
font-weight:700;
font-size:14px;
}

#pointBox .coin{
display:inline-flex;
align-items:center;
justify-content:center;
width:18px;
height:18px;
border-radius:50%;
background:#2a2a2a;
border:1px solid rgba(255,255,255,.6);
color:#fff;
font-size:12px;
}
#topRight{
position:absolute;
top:10px;
right:10px;
display:flex;
gap:8px;
z-index:30;
}
#menuBtn{
width:34px;
height:34px;
display:flex;
align-items:center;
justify-content:center;
background:#1a1a1a;
border:1px solid #fff;
border-radius:50%;
font-size:18px;
cursor:pointer;
}
header{
position:relative;
height:64px;   /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */
display:block;  /* ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á flex ‡πÅ‡∏•‡πâ‡∏ß */
z-index:30;
}
.banner{
margin-top:8px;   /* ‡∏´‡∏£‡∏∑‡∏≠ 16px ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏ä‡∏¥‡∏î */
}
.left{
position:absolute;
top:12px;
left:16px;
z-index:30;

display:flex;
flex-direction:column;
align-items:flex-start;
gap:4px;

pointer-events: auto; /* ‡∏Å‡∏±‡∏ô‡πÄ‡∏ú‡∏•‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π */
}

.title-logo{
width:56px;
opacity:.95;
}

.title-text{
font-weight:800;
font-size:15px;
line-height:1.1;     /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */
}
body.menu-open #topRight{
pointer-events:none;
opacity:.4;
}
.hide-point #pointBox{ display:none }
.auth-wrap{
min-height:100vh;
display:flex;
align-items:center;
justify-content:center;
background:radial-gradient(circle at top,#111,#000);
}

.auth-card{
width:90%;
max-width:360px;
background:#0f0f0f;
border:1px solid #222;
border-radius:14px;
padding:22px;
box-shadow:0 0 30px rgba(0,0,0,.8);
}

.auth-card h1{
margin:0;
font-size:20px;
}

.auth-card .sub{
opacity:.6;
margin-bottom:16px;
}

.auth-card input{
width:100%;
margin-bottom:10px;
padding:12px;
border-radius:10px;
border:1px solid #222;
background:#111;
color:#fff;
}

.auth-card button{
width:100%;
padding:12px;
border-radius:12px;
border:none;
background:#ff5a5a;
color:#000;
font-weight:bold;
}

button, a, input {
pointer-events:auto !important;
}

#menuBtn{
  z-index:9999;
}

.banner button{
  position:absolute;
  bottom:10px;
  left:50%;
  transform:translateX(-50%);
  z-index:100;
}
#menuOverlay{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  z-index:40;
}
nav{
  z-index:50;
}

</style>

</head>    
<body>    
<header>  
  <div id="topRight">  
    <div id="pointBox">  
      <span id="myPoint">0</span>  
      <span class="coin">ü™ô</span>  
    </div>  
    <div id="menuBtn" onclick="toggleMenu()">‚â°</div>  
  </div>    <div class="left">  
    <div class="title-text">DD WEB SHOP</div>  
    <img src="logo.png" class="title-logo">  
  </div>  
</header>   
  <nav id="menu">    
  <button onclick="go('home')">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>    
  <button onclick="go('category')">‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ß‡πá‡∏ö</button>    
  <button onclick="go('history')">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô</button>    
  <button onclick="go('topup')">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>    
  <button onclick="openAuth()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£ / ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</button>  
  
  <button onclick="testInsert()">TEST INSERT</button>
  
  <button onclick="go('contact')">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</button>    
  <button id="logoutBtn"        
    onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>  
  <button id="adminBtn" onclick="go('admin')" style="display:none">‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>    
</nav>    
<div id="menuOverlay" onclick="closeMenu()"></div>
<div id="notifyPopup" style="    
display:none;    
position:fixed;    
top:50%;    
left:50%;    
transform:translate(-50%,-50%);    
background:#111;    
color:#fff;    
padding:20px;    
border-radius:12px;    
box-shadow:0 0 30px rgba(0,0,0,.6);    
z-index:9999;    
text-align:center;    
">    
  <div id="notifyText"></div>    
  <button onclick="closeNotify()" style="    
  margin-top:15px;    
  padding:8px 16px;    
  border:none;    
  border-radius:8px;    
  background:#a00;    
  color:#fff;    
  ">‡πÇ‡∏≠‡πÄ‡∏Ñ</button>    
</div>  <section id="home" class="active">    
  <div class="banner" id="banner">    
    <div class="banner-track" id="bannerTrack">    
      <div class="banner-slide">Web UI Template</div>    
      <div class="banner-slide">Landing Page</div>    
      <div class="banner-slide">Shop Website</div>    
    </div>    
    
    <div class="dots" id="dots"></div>    
  </div>    <h3>‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h3>    
  <div class="grid" id="productGrid"></div>    <div class="stats">    
    <div class="stat">‡∏ú‡∏•‡∏á‡∏≤‡∏ô<br><b>12</b></div>    
    <div class="stat">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß<br><b>0</b></div>    
    <div class="stat">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤<br><b>0</b></div>    
  </div>    
</section>    
<section id="category">    
  <h3>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡πÄ‡∏ß‡πá‡∏ö</h3>    
  <div class="categories">    
    <button onclick="filter('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>    
    <button onclick="filter('shop')">‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á</button>    
    <button onclick="filter('landing')">Landing Page</button>    
  </div>    
  <div class="grid" id="catGrid"></div>    
</section>   
<!-- SEND WORK MODAL -->
<div id="sendWorkModal" style="
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.7);
z-index:9999;
align-items:center;
justify-content:center;
pointer-events:none;   /* üî• ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç */
">
  <div style="
  background:#111;
  padding:20px;
  border-radius:14px;
  width:90%;
  max-width:320px;
  pointer-events:auto; /* ‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡πÑ‡∏î‡πâ */
  ">
    <h3 style="margin-top:0">üì¶ ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>
    <input id="workLinkInput" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà">
    <div style="display:flex;gap:10px;margin-top:10px">
      <button class="buy" onclick="confirmSendWork()">‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</button>
      <button class="buy" style="background:#333;color:#fff" onclick="closeSendWork()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
    </div>
  </div>
</div>
 <section id="history">    
  <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>    
  <div id="historyList"></div>      <h4 style="margin-top:20px">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h4>    
</section>  <section id="topup">    
  <h3>‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>    
  <input id="topupLink" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ã‡∏≠‡∏á‡∏≠‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà">    
  <button class="buy" onclick="sendTopup()">‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>    
</section>    
<section id="auth">  
  <div class="auth-wrap">  <!-- REGISTER -->  
<div class="auth-card" id="registerBox">  
  <h1>DD WEB SHOP</h1>  
  <p class="sub">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>  

  <input id="regUser" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">  
  <input id="regPass" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">  

  <button onclick="register()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏•‡∏¢</button>  

  <p style="margin-top:14px;font-size:13px;opacity:.7">  
    ‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß?  
    <span style="color:#ff5a5a;cursor:pointer" onclick="showLogin()">  
      ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö  
    </span>  
  </p>  
</div>  

<!-- LOGIN -->  
<div class="auth-card" id="loginBox" style="display:none">  
  <h1>DD WEB SHOP</h1>  
  <p class="sub">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>  

  <input id="loginUser" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">  
  <input id="loginPass" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">  

  <button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>  

  <p style="margin-top:14px;font-size:13px;opacity:.7">  
    ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ?  
    <span style="color:#ff5a5a;cursor:pointer" onclick="showRegister()">  
      ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å  
    </span>  
  </p>  
</div>  

<div id="authStatus" style="margin-top:12px;color:#0f0"></div>

  </div>  
</section>  
<section id="contact">    
  <h3>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>    
  <a href="https://line.me/ti/p/~@darkdraft" target="_blank" style="text-decoration:none">    
    <div class="buy" style="background:#06c755;margin-bottom:10px">LINE : @darkdraft</div>    
  </a>    
  <a href="https://www.facebook.com/share/1NTP82Mywz/" target="_blank" style="text-decoration:none">    
    <div class="buy" style="background:#1877f2">FACEBOOK : Dark Draft</div>    
  </a>    
</section>    
<section id="admin">    
  <h3>‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>   
  <div id="adminPoint"></div>  
  <div id="topupList"></div>    
</section>   

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://sfnrtzjrbyhrwcuansbg.supabase.co"
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNmbnJ0empyYnlocndjdWFuc2JnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2NTE4NjYsImV4cCI6MjA4MjIyNzg2Nn0.EdoCe7UMyBz5BmbjVSwmb1ZMGROCbmekUzIZrpFJjEM"

const supabaseClient = supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
)

supabaseClient.auth.onAuthStateChange((event, session) => {
  if (session?.user) {
    current = session.user.id
    localStorage.setItem("login", current)
    document.getElementById('logoutBtn').style.display = "inline-block"
    renderPoint()
  } else {
    localStorage.removeItem("login")
    current = ''
    document.getElementById('logoutBtn').style.display = "none"
    go('home')
  }
})
</script>

<script>
/* ======================
GLOBAL STATE
====================== */
let current = localStorage.getItem('login') || ''
let points = JSON.parse(localStorage.getItem('points') || '{}')
let sendWorkIndex = null

const menu = document.getElementById('menu')
const productGrid = document.getElementById('productGrid')
const catGrid = document.getElementById('catGrid')
const historyList = document.getElementById('historyList')
const topupList = document.getElementById('topupList')
const adminBtn = document.getElementById('adminBtn')
const logoutBtn = document.getElementById('logoutBtn')

const registerBox = document.getElementById('registerBox')
const loginBox = document.getElementById('loginBox')
const authStatus = document.getElementById('authStatus')
const regUser = document.getElementById('regUser')
const regPass = document.getElementById('regPass')
const loginUser = document.getElementById('loginUser')
const loginPass = document.getElementById('loginPass')
/* ======================
INIT
====================== */
if(!current){
  logoutBtn.style.display='none'
}else{
  renderPoint()
}
if(current==='admin') adminBtn.style.display='block'

/* ======================
DATA
====================== */
const products = [
  {id:'A',name:'‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡∏≤‡∏¢‡∏£‡∏´‡∏±‡∏™ V1',price:499,type:'shop'},
  {id:'B',name:'‡πÄ‡∏ß‡πá‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤ Dark UI',price:799,type:'shop'},
  {id:'C',name:'Landing Page ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå',price:299,type:'landing'},
  {id:'D',name:'‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á UI ‡πÇ‡∏´‡∏î',price:999,type:'shop'}
]

/* ======================
UTIL STORAGE
====================== */
const getOrders = u => JSON.parse(localStorage.getItem('orders_'+u)||'[]')
const saveOrders = (u,d)=>localStorage.setItem('orders_'+u,JSON.stringify(d))
const getAllOrders = ()=>JSON.parse(localStorage.getItem('orders_all')||'[]')
const saveAllOrders = d=>localStorage.setItem('orders_all',JSON.stringify(d))
const savePoints = ()=>localStorage.setItem('points',JSON.stringify(points))

/* ======================
POINT
====================== */
function renderPoint(){
  document.getElementById('myPoint').innerText = points[current] ?? 0
}

/* ======================
SHOP
====================== */
function render(){
  productGrid.innerHTML=''
  products.forEach(p=>{
    productGrid.innerHTML+=`
      <div class="card">
        <div class="img">Web UI</div>
        <b>${p.name}</b><br>
        <span class="price">${p.price} ‡∏ö‡∏≤‡∏ó</span>
        <button class="buy" onclick="buy('${p.id}')">‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô</button>
      </div>`
  })
}
render()

async function buy(id){
  if(!current) return alert('‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô')

  const { data } = await supabaseClient.auth.getSession()
const user = data.session?.user
if(!user) return alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á')

  const p = products.find(x=>x.id===id)

  const { error } = await supabaseClient
    .from('orders')
    .insert({
      user_id: user.id,
      product: p.name,
      price: p.price,
      status: '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
      work_link: ''
    })

  if(error){
    alert(error.message)
  }else{
    alert('‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏Ç‡πâ‡∏≤ DB ‡πÅ‡∏•‡πâ‡∏ß üî•')
  }
}

/* ======================
HISTORY
====================== */
async function renderHistoryForUser(){
  historyList.innerHTML=''

  const { data: sessionData } = await supabaseClient.auth.getSession()
  const user = sessionData.session?.user
  if(!user) return

  const { data: orders, error } = await supabaseClient
    .from('orders')
    .select('*')
    .eq('user_id', user.id)
    .order('created_at', { ascending:false })

  if(error){
    historyList.innerHTML = '‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ'
    return
  }

  if(!orders.length){
    historyList.innerHTML = '<div class="history-item">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>'
    return
  }

  orders.forEach(o=>{
    historyList.innerHTML += `
      <div class="history-item">
        ${o.product}<br>
        ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <b>${o.status}</b><br>
        ‡∏£‡∏≤‡∏Ñ‡∏≤: ${o.price}<br>
        ${
          o.work_link
          ? `<a href="${o.work_link}" target="_blank">üîó ‡πÄ‡∏õ‡∏¥‡∏î‡∏á‡∏≤‡∏ô</a>`
          : '‚è≥ ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£'
        }
      </div>
    `
  })
}

/* ======================
AUTH
====================== */
function showLogin(){
  registerBox.style.display='none'
  loginBox.style.display='block'
  authStatus.innerText=''
}
function showRegister(){
  loginBox.style.display='none'
  registerBox.style.display='block'
  authStatus.innerText=''
}

async function register(){
  const username = regUser.value.trim()
  const password = regPass.value.trim()
  if(!username || !password){
    authStatus.innerText = "‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö"
    return
  }

  const email = username + "@ddshop.com"

  const { error } = await supabaseClient.auth.signUp({
    email,
    password
  })

  if(error){
    authStatus.innerText = error.message
  }else{
    authStatus.innerText = "‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üî• ‡πÑ‡∏õ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢"
    showLogin()
  }
}
async function login(){
  const email = loginUser.value.trim() + "@dd.local"
  const password = loginPass.value.trim()
  if(!password) return authStatus.innerText="‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö"

  const { data, error } = await supabaseClient.auth.signInWithPassword({
    email,
    password
  })

  if(error){
    authStatus.innerText = error.message
  }else{
    current = data.user.id
    localStorage.setItem("login", current)
    logoutBtn.style.display = "inline-block"
    go("home")
  }
}

async function logout(){
  await supabaseClient.auth.signOut()
  localStorage.removeItem('login')
  current=''
  logoutBtn.style.display='none'
  adminBtn.style.display='none'
  go('auth')
}
/* ======================
NAV
====================== */
function go(id){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'))
  document.getElementById(id).classList.add('active')
  if(id==='history' && current) renderHistoryForUser()
  menu.classList.remove('active')
}

function openAuth(){
  if(current){
    alert('‡∏°‡∏∂‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏≠‡πÄ‡∏´‡∏µ‡πâ‡∏¢')
  }else{
    go('auth')
    closeMenu()
  }
}

/* ======================
MENU
====================== */
function toggleMenu(){
  const overlay = document.getElementById('menuOverlay')
  const isOpen = menu.classList.toggle('active')
  overlay.style.display = isOpen ? 'block' : 'none'
}
function closeMenu(){
  menu.classList.remove('active')
  document.getElementById('menuOverlay').style.display='none'
}
/* ======================
BANNER SLIDE
====================== */
let slideIndex = 0
const track = document.getElementById('bannerTrack')
const slides = document.querySelectorAll('.banner-slide')
const dotsBox = document.getElementById('dots')

slides.forEach((_,i)=>{
  const d=document.createElement('div')
  d.className='dot'+(i===0?' active':'')
  d.onclick=()=>goSlide(i)
  dotsBox.appendChild(d)
})

function goSlide(i){
  slideIndex=i
  track.style.transform=`translateX(-${i*100}%)`
  document.querySelectorAll('.dot').forEach((d,idx)=>{
    d.classList.toggle('active',idx===i)
  })
}

setInterval(()=>{
  slideIndex=(slideIndex+1)%slides.length
  goSlide(slideIndex)
},3000)
(async ()=>{
  const { data } = await supabaseClient.auth.getSession()
  if(data.session?.user){
    current = data.session.user.id
    localStorage.setItem("login", current)
    logoutBtn.style.display = "inline-block"
    go('home')
  }else{
    go('home')
  }
})()

async function testInsert(){
  
  const { data } = await supabaseClient.auth.getSession()
const user = data.session?.user
if(!user) return alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á')

  const { error } = await supabaseClient
    .from('orders')
    .insert({
      user_id: user.id,
      product: 'TEST',
      price: 100,
      status: 'test',
      work_link: ''
    })

  if(error){
    alert(error.message)
  }else{
    alert('‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏≠‡πâ‡πÄ‡∏´‡∏µ‡πâ‡∏¢ üéâ')
}
}
function openSendWork(){
  const m = document.getElementById('sendWorkModal')
  m.style.display = 'flex'
  m.style.pointerEvents = 'auto'
}

function closeSendWork(){
  const m = document.getElementById('sendWorkModal')
  m.style.display = 'none'
  m.style.pointerEvents = 'none'
}
</script>
 </body>    
   </html>
